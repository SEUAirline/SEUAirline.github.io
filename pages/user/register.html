<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SEUAirline - 用户注册</title>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- FontAwesome -->
  <link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">

  <!-- 自定义样式 -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#1E3A8A',
            secondary: '#3B82F6',
            accent: '#F8FAFC'
          }
        }
      }
    }
  </script>

  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto { content-visibility: auto; }
      .btn-primary { 
        @apply bg-primary text-white px-6 py-3 rounded-md hover:bg-primary/90 transition-all duration-300 font-medium;
      }
      .btn-secondary { 
        @apply bg-white text-primary border border-primary px-4 py-2 rounded-md hover:bg-gray-50 transition-all duration-300;
      }
      .input-field { 
        @apply w-full pl-10 pr-4 py-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary; 
      }
      .input-success { 
        @apply border-green-500 focus:border-green-500 focus:ring-green-500/50;
      }
      .input-error { 
        @apply border-red-500 focus:border-red-500 focus:ring-red-500/50;
      }
      .step-active {
        @apply bg-primary text-white;
      }
      .step-completed {
        @apply bg-green-500 text-white;
      }
      .step-line {
        @apply h-1 bg-gray-200 flex-1;
      }
      .step-line-active {
        @apply bg-primary;
      }
    }
  </style>
</head>

<body class="bg-gray-50 min-h-screen">
  <!-- 导航栏 -->
  <nav class="bg-white shadow-sm">
    <div class="container mx-auto px-4">
      <div class="flex justify-between items-center h-16">
        <div class="flex items-center">
          <a href="javascript:void(0)" onclick="parent.switchPage('pages/user/homepage.html')" class="flex items-center">
            <i class="fas fa-plane text-primary text-2xl mr-2"></i>
            <span class="text-xl font-bold text-primary">SEUAirline</span>
          </a>
        </div>

        <div class="hidden md:flex space-x-8">
          <a href="javascript:void(0)" onclick="parent.switchPage('pages/user/homepage.html')" class="text-gray-600 hover:text-primary"
            onclick="event.preventDefault(); if(parent && parent.switchPage){parent.switchPage('pages/user/homepage.html');}">首页</a>
          <a href="javascript:void(0)" onclick="parent.switchPage('pages/user/view_orders.html')" class="text-gray-600 hover:text-primary"
            onclick="event.preventDefault(); if(parent && parent.switchPage){parent.switchPage('pages/user/view_orders.html');}">我的订单</a>
          <a href="javascript:void(0)" onclick="parent.switchPage('pages/user/user_center.html')" class="text-gray-600 hover:text-primary"
            onclick="event.preventDefault(); if(parent && parent.switchPage){parent.switchPage('pages/user/user_center.html');}">个人中心</a>
        </div>

        <div class="flex items-center">
          <button class="md:hidden text-gray-600">
            <i class="fas fa-bars text-xl"></i>
          </button>
        </div>
      </div>
    </div>
  </nav>

  <!-- 主要内容区 -->
  <main class="container mx-auto px-4 py-12">
    <div class="max-w-md mx-auto">
      <div class="text-center mb-8">
        <h1 class="text-2xl md:text-3xl font-bold text-gray-800">注册SEUAirline账号</h1>
        <p class="text-gray-600 mt-2">加入我们，享受便捷的航空服务</p>
      </div>

      <!-- 注册卡片 -->
      <div class="bg-white rounded-xl p-8 shadow-lg">
        <!-- 步骤指示器 -->
        <div class="flex items-center justify-between mb-8">
          <div class="flex flex-col items-center w-1/3">
            <div id="step1-circle" class="w-10 h-10 rounded-full flex items-center justify-center step-active">1</div>
            <span class="text-xs mt-2 text-primary font-medium">基本信息</span>
          </div>
          <div class="step-line" id="line1-2"></div>
          <div class="flex flex-col items-center w-1/3">
            <div id="step2-circle"
              class="w-10 h-10 rounded-full flex items-center justify-center bg-gray-200 text-gray-500">2</div>
            <span class="text-xs mt-2 text-gray-500">验证信息</span>
          </div>
          <div class="step-line" id="line2-3"></div>
          <div class="flex flex-col items-center w-1/3">
            <div id="step3-circle"
              class="w-10 h-10 rounded-full flex items-center justify-center bg-gray-200 text-gray-500">3</div>
            <span class="text-xs mt-2 text-gray-500">设置完成</span>
          </div>
        </div>

        <!-- 步骤1：基本信息 -->
        <div id="step1" class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">手机号码</label>
            <div class="relative">
              <i class="fas fa-mobile absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 text-xl"></i>
              <input type="tel" id="phone" class="input-field pl-10" placeholder="请输入手机号码">
              <span id="phone-status" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-sm hidden"></span>
            </div>
            <p id="phone-error" class="text-red-500 text-xs mt-1 hidden">请输入正确的手机号码</p>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">验证码</label>
            <div class="flex space-x-2">
              <div class="relative flex-1">
                <i class="fas fa-shield absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                <input type="text" id="verify-code" class="input-field pl-10" placeholder="请输入验证码">
              </div>
              <button type="button" id="send-verify-code"
                class="px-4 py-3 bg-blue-50 text-primary font-medium rounded-md whitespace-nowrap">
                获取验证码
              </button>
            </div>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">设置密码</label>
            <div class="relative">
              <i class="fas fa-lock absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
              <input type="password" id="set-password" class="input-field pl-10" placeholder="请设置6-20位密码"
                autocomplete="new-password">
              <button type="button" id="toggle-password-visibility"
                class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400">
                <i class="fas fa-eye"></i>
              </button>
            </div>
            <div class="flex space-x-1 mt-1">
              <div id="password-strength-1" class="h-1 flex-1 bg-gray-200 rounded-full"></div>
              <div id="password-strength-2" class="h-1 flex-1 bg-gray-200 rounded-full"></div>
              <div id="password-strength-3" class="h-1 flex-1 bg-gray-200 rounded-full"></div>
            </div>
            <p id="password-hint" class="text-gray-500 text-xs mt-1">密码应包含字母和数字</p>
          </div>

          <div class="pt-4">
            <button id="to-step2" class="w-full btn-primary">下一步</button>
          </div>
        </div>

        <!-- 步骤2：验证信息 (默认隐藏) -->
        <div id="step2" class="space-y-4 hidden">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">真实姓名</label>
            <div class="relative">
              <i class="fas fa-user absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
              <input type="text" id="real-name" class="input-field pl-10" placeholder="请输入真实姓名">
            </div>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">身份证号码</label>
            <div class="relative">
              <i class="fas fa-id-card absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
              <input type="text" id="id-card" class="input-field pl-10" placeholder="请输入身份证号码">
            </div>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">电子邮箱（选填）</label>
            <div class="relative">
              <i class="fas fa-envelope absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
              <input type="email" id="email" class="input-field pl-10" placeholder="请输入电子邮箱">
            </div>
          </div>

          <div class="flex items-start pt-2">
            <input type="checkbox" id="agree-terms" class="h-4 w-4 mt-1 text-primary border-gray-300 rounded">
            <div class="ml-2 text-sm">
              <label for="agree-terms" class="text-gray-600">我已阅读并同意</label>
              <a href="#" class="text-primary hover:underline">《用户协议》</a>
              <span class="text-gray-600">和</span>
              <a href="#" class="text-primary hover:underline">《隐私政策》</a>
            </div>
          </div>

          <div class="pt-4 flex space-x-3">
            <button id="back-to-step1" class="flex-1 btn-secondary">上一步</button>
            <button id="to-step3" class="flex-1 btn-primary">完成注册</button>
          </div>
        </div>

        <!-- 步骤3：设置完成 (默认隐藏) -->
        <div id="step3" class="text-center py-8 hidden">
          <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6">
            <i class="fas fa-check text-3xl text-green-500"></i>
          </div>
          <h2 class="text-2xl font-bold text-gray-800 mb-2">注册成功！</h2>
          <p class="text-gray-600 mb-8">欢迎加入SEUAirline，您的账号已成功创建</p>

          <div class="bg-blue-50 rounded-lg p-4 mb-6">
            <p class="text-blue-700 text-sm">
              <i class="fas fa-info-circle mr-2"></i>
              新用户专享：首次预订可获得<span class="font-bold">1000积分</span>奖励
            </p>
          </div>

          <button id="go-to-login" class="w-full btn-primary">
            立即登录
          </button>
        </div>
      </div>

      <!-- 登录提示 -->
      <div class="mt-6 text-center">
        <span class="text-gray-600">已有账号？</span>
        <a href="javascript:void(0)" onclick="parent.switchPage('pages/user/login.html')"
          onclick="if (parent && parent.switchPage) { parent.switchPage('pages/user/login.html'); return false; }"
          class="text-primary font-medium hover:text-primary/80 ml-1">立即登录</a>
      </div>
    </div>
  </main>

  <!-- 页脚 -->
  <footer class="mt-12 py-6 bg-white border-t border-gray-200">
    <div class="container mx-auto px-4 text-center">
      <p class="text-gray-500 text-sm">© 2024 SEUAirline. 保留所有权利。</p>
    </div>
  </footer>

  <!-- JavaScript -->
  <script src="../../data/mock-api.js"></script>
  <script>
    // 步骤元素
    const step1 = document.getElementById('step1');
    const step2 = document.getElementById('step2');
    const step3 = document.getElementById('step3');
    const step1Circle = document.getElementById('step1-circle');
    const step2Circle = document.getElementById('step2-circle');
    const step3Circle = document.getElementById('step3-circle');
    const line12 = document.getElementById('line1-2');
    const line23 = document.getElementById('line2-3');

    // 手机号验证
    const phoneInput = document.getElementById('phone');
    const phoneError = document.getElementById('phone-error');
    const phoneStatus = document.getElementById('phone-status');

    phoneInput.addEventListener('input', () => {
      const phone = phoneInput.value.trim();
      const phoneRegex = /^1[3-9]\d{9}$/;

      if (phoneRegex.test(phone)) {
        phoneInput.classList.add('input-success');
        phoneInput.classList.remove('input-error');
        phoneError.classList.add('hidden');
        phoneStatus.innerHTML = '<i class="fas fa-check-circle text-green-500"></i>';
        phoneStatus.classList.remove('hidden');
      } else if (phone) {
        phoneInput.classList.add('input-error');
        phoneInput.classList.remove('input-success');
        phoneError.classList.remove('hidden');
        phoneStatus.classList.add('hidden');
      } else {
        phoneInput.classList.remove('input-success', 'input-error');
        phoneError.classList.add('hidden');
        phoneStatus.classList.add('hidden');
      }
    });

    // 密码强度检测
    const passwordInput = document.getElementById('set-password');
    const strength1 = document.getElementById('password-strength-1');
    const strength2 = document.getElementById('password-strength-2');
    const strength3 = document.getElementById('password-strength-3');
    const passwordHint = document.getElementById('password-hint');

    passwordInput.addEventListener('input', () => {
      const password = passwordInput.value;

      if (password.length === 0) {
        strength1.className = 'h-1 flex-1 bg-gray-200 rounded-full';
        strength2.className = 'h-1 flex-1 bg-gray-200 rounded-full';
        strength3.className = 'h-1 flex-1 bg-gray-200 rounded-full';
        passwordHint.textContent = '密码应包含字母和数字';
        return;
      }

      let strength = 0;

      // 长度检查
      if (password.length >= 6) strength++;
      if (password.length >= 10) strength++;

      // 复杂度检查
      if (/[a-zA-Z]/.test(password) && /[0-9]/.test(password)) strength++;
      if (/[^a-zA-Z0-9]/.test(password)) strength++;

      // 更新强度条
      if (strength <= 1) {
        strength1.className = 'h-1 flex-1 bg-red-500 rounded-full';
        strength2.className = 'h-1 flex-1 bg-gray-200 rounded-full';
        strength3.className = 'h-1 flex-1 bg-gray-200 rounded-full';
        passwordHint.textContent = '密码强度：弱';
        passwordHint.className = 'text-red-500 text-xs mt-1';
      } else if (strength <= 3) {
        strength1.className = 'h-1 flex-1 bg-yellow-500 rounded-full';
        strength2.className = 'h-1 flex-1 bg-yellow-500 rounded-full';
        strength3.className = 'h-1 flex-1 bg-gray-200 rounded-full';
        passwordHint.textContent = '密码强度：中';
        passwordHint.className = 'text-yellow-500 text-xs mt-1';
      } else {
        strength1.className = 'h-1 flex-1 bg-green-500 rounded-full';
        strength2.className = 'h-1 flex-1 bg-green-500 rounded-full';
        strength3.className = 'h-1 flex-1 bg-green-500 rounded-full';
        passwordHint.textContent = '密码强度：强';
        passwordHint.className = 'text-green-500 text-xs mt-1';
      }
    });

    // 密码显示切换
    const togglePassword = document.getElementById('toggle-password-visibility');
    togglePassword.addEventListener('click', () => {
      const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
      passwordInput.setAttribute('type', type);
      togglePassword.innerHTML = type === 'password' ? '<i class="fas fa-eye"></i>' : '<i class="fas fa-eye-slash"></i>';
    });

    // 发送验证码
    const sendVerifyCodeBtn = document.getElementById('send-verify-code');
    sendVerifyCodeBtn.addEventListener('click', () => {
      const phone = phoneInput.value.trim();

      if (!/^1[3-9]\d{9}$/.test(phone)) {
        alert('请输入正确的手机号码');
        return;
      }

      // 倒计时
      let countdown = 60;
      sendVerifyCodeBtn.disabled = true;
      sendVerifyCodeBtn.textContent = `${countdown}秒后重发`;

      const timer = setInterval(() => {
        countdown--;
        sendVerifyCodeBtn.textContent = `${countdown}秒后重发`;

        if (countdown <= 0) {
          clearInterval(timer);
          sendVerifyCodeBtn.disabled = false;
          sendVerifyCodeBtn.textContent = '获取验证码';
        }
      }, 1000);

      // 模拟发送验证码
      alert(`验证码已发送至 ${phone}`);
    });

    // 步骤切换
    document.getElementById('to-step2').addEventListener('click', () => {
      const phone = phoneInput.value.trim();
      const verifyCode = document.getElementById('verify-code').value.trim();
      const password = passwordInput.value;

      if (!/^1[3-9]\d{9}$/.test(phone)) {
        alert('请输入正确的手机号码');
        return;
      }

      if (!verifyCode) {
        alert('请输入验证码');
        return;
      }

      if (password.length < 6) {
        alert('请设置6-20位密码');
        return;
      }

      // 更新步骤指示器
      step1Circle.classList.remove('step-active');
      step1Circle.classList.add('step-completed');
      step1Circle.innerHTML = '<i class="fas fa-check"></i>';
      step2Circle.classList.remove('bg-gray-200', 'text-gray-500');
      step2Circle.classList.add('step-active');
      line12.classList.add('step-line-active');

      // 切换到步骤2
      step1.classList.add('hidden');
      step2.classList.remove('hidden');
    });

    document.getElementById('back-to-step1').addEventListener('click', () => {
      // 更新步骤指示器
      step1Circle.classList.remove('step-completed');
      step1Circle.classList.add('step-active');
      step1Circle.textContent = '1';
      step2Circle.classList.add('bg-gray-200', 'text-gray-500');
      step2Circle.classList.remove('step-active');
      line12.classList.remove('step-line-active');

      // 切换到步骤1
      step2.classList.add('hidden');
      step1.classList.remove('hidden');
    });

    document.getElementById('to-step3').addEventListener('click', () => {
      const realName = document.getElementById('real-name').value.trim();
      const idCard = document.getElementById('id-card').value.trim();
      const agreeTerms = document.getElementById('agree-terms').checked;

      if (!realName) {
        alert('请输入真实姓名');
        return;
      }

      if (!/^\d{17}[\dXx]$/.test(idCard)) {
        alert('请输入正确的身份证号码');
        return;
      }

      if (!agreeTerms) {
        alert('请阅读并同意用户协议和隐私政策');
        return;
      }

      // 收集用户注册数据
      const userData = {
        phone: document.getElementById('phone').value.trim(),
        password: document.getElementById('set-password').value,
        realName: realName,
        idCard: idCard,
        email: document.getElementById('email').value.trim()
      };

      // 调用注册API
      const result = MockAPI.register(userData);

      if (result.success) {
        // 更新步骤指示器
        step2Circle.classList.remove('step-active');
        step2Circle.classList.add('step-completed');
        step2Circle.innerHTML = '<i class="fas fa-check"></i>';
        step3Circle.classList.remove('bg-gray-200', 'text-gray-500');
        step3Circle.classList.add('step-completed');
        step3Circle.innerHTML = '<i class="fas fa-check"></i>';
        line23.classList.add('step-line-active');

        // 切换到步骤3
        step2.classList.add('hidden');
        step3.classList.remove('hidden');
      } else {
        alert('注册失败，请稍后重试');
      }
    });

    document.getElementById('go-to-login').addEventListener('click', () => {
      if (parent && parent.switchPage) {
        parent.switchPage('pages/user/login.html');
      } else {
        window.location.href = 'login.html';
      }
    });
  </script>
</body>

</html>